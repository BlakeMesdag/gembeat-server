require 'test_helper'

class VulnerabilityAssessmentTest < ActiveSupport::TestCase
  def setup
    @dependency = dependencies(:gembeat_dependency)
    @vulnerability = vulnerabilities(:rails)
    @vulnerability_assessment = vulnerability_assessments(:rails)
  end

  test "dependency can only be associated to each vulnerability once" do
    assert_difference "VulnerabilityAssessment.count", 0 do
      VulnerabilityAssessment.create(:dependency_id => @dependency.id, :vulnerability_id => @vulnerability.id, :vulnerable => false)
    end
  end
end
